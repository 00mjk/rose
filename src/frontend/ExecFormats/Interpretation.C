#include "rose.h"

/* Class definition for SgAsmInterpretation is generated by Rosetta and appears in src/ROSETTA/src/binaryInstruction.C */


/** Returns a list of all files referenced by an interpretation.  It does this by looking at the file headers referenced by
 *  the interpretation, following their parent pointers up to an SgAsmGenericFile node, and returning a vector of those nodes
 *  with duplicate files removed. */
SgAsmGenericFilePtrList
SgAsmInterpretation::get_files() const
{

    SgAsmGenericHeaderPtrList headers;
    headers.push_back(get_header());

    std::set<SgAsmGenericFile*> files;
    for (size_t i=0; i<headers.size(); i++) {
        SgAsmGenericHeader *header = headers[i];
        SgAsmGenericFile *file = NULL;
        for (SgNode *node=headers[i]; node && !file; node=node->get_parent())
            file = isSgAsmGenericFile(node);
        ROSE_ASSERT(file!=NULL);
        files.insert(file);
    }

    return SgAsmGenericFilePtrList(files.begin(), files.end());
}

    
