{\rtf1\ansi\ansicpg1252\cocoartf1038\cocoasubrtf290
{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 Monaco;}
{\colortbl;\red255\green255\blue255;\red108\green108\blue108;\red0\green0\blue0;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\f0\b\fs24 \cf2 From: 
\b0 \cf3 Laksono Adhianto <laksono@rice.edu>\

\b \cf2 Date: 
\b0 \cf3 September 29, 2010 1:26:10 PM CDT\

\b \cf2 To: 
\b0 \cf3 Dan Quinlan <dquinlan@llnl.gov>\

\b \cf2 Cc: 
\b0 \cf3 Dung Nguyen <dxnguyen@rice.edu>\

\b \cf2 Subject: \cf3 Rose bug: unimplemented SgTypeComplex\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\b0 \cf3 \
\pard\pardeftab720\ql\qnatural
\cf3 \
\
In src/frontend/OpenFortranParser_SAGE_Connection/FortranParserActionROSE.C\
\
\'a0 894\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 default:\
\'a0 895\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 \{\
\'a0 896\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 // I think that only the COMPLEX type might be left.\
\'a0 897\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 printf ("Error: unimplemented type = %s \\n",intrinsicType->class_name().c_str());\
\'a0 898\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 ROSE_ASSERT(false);\
\'a0 899\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 break;\
\'a0 900\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 \}\
\
Our solution:\
\
\'a0 894\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 case V_SgTypeComplex: \{\
\'a0 895\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 // Rice 2010.09.22: add modifier for complex type\
\'a0 896\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 SgModifierType* typeFromKindExpression = SageBuilder::buildFortranKindType(SgTypeComplex::createType(SgTypeFloat::createType()),lengthExpression);\
\'a0 897\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 ROSE_ASSERT(typeFromKindExpression != NULL);\
\'a0 898 \
\'a0 899\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 // Replace the base type with the just built string type\
\'a0 900\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 astBaseTypeStack.pop_front();\
\'a0 901\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 astBaseTypeStack.push_front(typeFromKindExpression);\
\'a0 902\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 break;\
\'a0 903\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 \}\
\'a0 904\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0\'a0 default:\
......\
\
\
Let us know if this is a correct implementation or not.\
\
Thanks.\
\
Laksono Adhianto\
\
\page \pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\b \cf2 From: 
\b0 \cf3 Laksono Adhianto <laksono@rice.edu>\

\b \cf2 Date: 
\b0 \cf3 September 29, 2010 1:12:45 PM CDT\

\b \cf2 To: 
\b0 \cf3 Dan Quinlan <dquinlan@llnl.gov>\

\b \cf2 Cc: 
\b0 \cf3 Dung Nguyen <dxnguyen@rice.edu>\

\b \cf2 Subject: \cf3 Rose bug: Mangled ID string of cray pointer\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\b0 \cf3 \
\pard\pardeftab720\ql\qnatural
\cf3 Dan, \
\
The following code in Rose causes an error when creating cray pointer (in File in the original ROSETTA/src/type.C):\
\pard\pardeftab720\ql\qnatural

\f1\fs20 \cf3 726      TypeCrayPointer.editSubstitute        ( "MANGLED_ID_STRING", "s" );\
\pard\pardeftab720\ql\qnatural

\f0\fs24 \cf3 \
If we changed to:\
\
\pard\pardeftab720\ql\qnatural

\f1\fs20 \cf3 726      TypeCrayPointer.editSubstitute        ( "MANGLED_ID_STRING", "CrayPointer" );\
\pard\pardeftab720\ql\qnatural

\f0\fs24 \cf3 \
It works fine.\
\
Regards,\
\
\
Laksono Adhianto\
\
\page \pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\b \cf2 From: 
\b0 \cf3 Laksono Adhianto <laksono@rice.edu>\

\b \cf2 Date: 
\b0 \cf3 September 29, 2010 1:04:42 PM CDT\

\b \cf2 To: 
\b0 \cf3 Dan Quinlan <dquinlan@llnl.gov>\

\b \cf2 Cc: 
\b0 \cf3 Dung Nguyen <dxnguyen@rice.edu>\

\b \cf2 Subject: \cf3 Rose bug: Pointer attribute (located at the end) disappears\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural

\b0 \cf3 \
\pard\pardeftab720\ql\qnatural
\cf3 In m.f90:\
\
Module m\
\'a0real, pointer, dimension(:) :: x\
\'a0real, dimension(:), pointer :: y\
end module\
\
Rose will unparse as the following:\
\
MODULE m\
REAL, DIMENSION(:), POINTER :: x\
REAL, DIMENSION(:) :: y\
\
END MODULE m\
\
the variable x is correct, but the attribute pointer in variable y disappears\
\
Laksono Adhianto\
}