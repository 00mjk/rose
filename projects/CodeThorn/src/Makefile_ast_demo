# MS: makefile for local development with installed version of ROSE.

TOOLNAME = ast_demo
MYDATE = `date +%Y_%m_%d`

HOME_DIR = /home/schordan
CC                    = gcc-4.4
CXX                   = g++-4.4

# Location of include directory after "make install" (set as environment variable)
#ROSE_INCLUDE_DIR = 

# Location of Boost include directory (set as environment variable)
#BOOST_CPPFLAGS = 

# Location of library directory after "make install" (set as environment variable)
#ROSE_LIB_DIR = 
ROSE_LIBS = -Wl,-rpath -Wl,$(ROSE_LIB_DIR) -L $(ROSE_LIB_DIR) -lrose

CPPFLAGS              = -O3
#CXXCPPFLAGS           = @CXXCPPFLAGS@
CXXFLAGS              = 
LDFLAGS               = 
YACC                  = bison

# Default make rule to use
  all: $(TOOLNAME)
	@if [ x$${ROSE_IN_BUILD_TREE:+present} = xpresent ]; then echo "ROSE_IN_BUILD_TREE should not be set" >&2; exit 1; fi

# Example suffix rule for more experienced makefile users
# .C.o:
#	g++ -c -I$(ROSE_INCLUDE_DIR) -o $@ $(@:.o=.C)

$(TOOLNAME): $(TOOLNAME).C RoseAst.h RoseAst.C AstTerm.h AstTerm.C SgNodeHelper.h SgNodeHelper.C $(TOOLNAME).C
	$(CXX) $(CXXFLAGS)  $(CPPFLAGS) -I$(ROSE_INCLUDE_DIR) $(BOOST_CPPFLAGS) -L$(ROSE_LIB_DIR) -lrose $(TOOLNAME).C -o$(TOOLNAME) 

# Rule used by make installcheck to verify correctness of installed libraries
check:	$(TOOLNAME)
	./$(TOOLNAME) tests/basictest9.C
	@dot -Tps astmain.dot -oastmain.ps

check2:	$(TOOLNAME)
	./$(TOOLNAME) -Itests tests/GrammarIr.C

clean:
	rm -f $(TOOLNAME)

distclean: clean
	rm -f *.tgz
	rm -f *~

dist:
	tar cvzf ast_demo.tgz ast_demo.C AstTerm.h AstTerm.C Makefile_ast_demo RoseAst.h RoseAst.C SgNodeHelper.h SgNodeHelper.C Timer.h Timer.cpp tests
