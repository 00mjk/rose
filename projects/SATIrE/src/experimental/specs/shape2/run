#!/bin/bash

# shape analysis driver stub
# Viktor Pavlu, 2008

impls="srw98 nnh99"

# check what implementations are compiled
binaries=''
for impl in $impls; do
  if [ -e "$impl/$impl" ]; then
    binaries="$binaries $impl"
  else
    echo "info: run 'make' to build $impl"
  fi
done
binaries=${binaries:1}

if [ "$binaries" = '' ]; then
  echo "no analyses found."
  exit 1
fi

if [ "$#" -lt 2 ]; then
  echo "usage: $0 ${binaries/ /|} FILES"
  exit 1
fi

found=0
for b in $binaries; do
  if [ "$b" = "$1" ]; then
    found=1
  fi
done

if [ "$found" = "0" ]; then
  echo "analysis '$1' not found. try one of these: $binaries"
  exit 1
fi

cmd="$1/$1 --output-gdl=$1.gdl"
shift
$cmd $*
