#!/bin/sh 

FILES=`ls tests/*.[cC]`

# Known to work
./constprop tests/classes2.C >/dev/null || exit 1
./constprop tests/blocks.c   >/dev/null || exit 1

./constprop tests/blocks.c --textoutput   >/dev/null || exit 1
./constprop tests/blocks.c --termoutput   >/dev/null || exit 1
./constprop tests/blocks.c --sourceoutput >/dev/null || exit 1

# possibly buggy
echo $FILES
for file in $FILES;
do
  echo "######## Testing $file"
  set -x
  ./constprop $file --textoutput    >/dev/null || exit 1
  ./constprop $file --termoutput    >/dev/null || exit 1
  ./constprop $file --sourceoutput  >/dev/null || exit 1
  set +x
done